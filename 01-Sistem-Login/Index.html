<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <style>
      body { font-family: Arial, sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; background: #f4f7f6; }
      .container { width: 90%; max-width: 400px; padding: 20px; background: white; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); text-align: center; }
      input { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 5px; box-sizing: border-box; }
      button { width: 100%; padding: 12px; background: #28a745; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; }
      .hidden { display: none; }
      #status { color: red; margin-top: 10px; }
    </style>
  </head>
  <body>

    <div id="login-page" class="container">
      <h2>Si-Pintar Login</h2>
      <input type="text" id="user" placeholder="Username">
      <input type="password" id="pass" placeholder="Password">
      <button onclick="login()">Masuk</button>
      <div id="status"></div>
    </div>

    <div id="confirm-page" class="container hidden">
      <h2>Konfirmasi Data</h2>
      <p>Selamat Datang, <br><strong id="guru-name"></strong></p>
      <p>Anda akan diarahkan ke Dashboard Guru.</p>
      <button style="background: #007bff;" id="btn-dashboard">Buka Dashboard</button>
    </div>

    <script>
      function login() {
        var user = document.getElementById('user').value;
        var pass = document.getElementById('pass').value;
        document.getElementById('status').innerText = "Memproses...";

        google.script.run.withSuccessHandler(function(res) {
          if (res.status === "success") {
            // Sembunyikan Login, Tampilkan Konfirmasi
            document.getElementById('login-page').classList.add('hidden');
            document.getElementById('confirm-page').classList.remove('hidden');
            document.getElementById('guru-name').innerText = res.nama;
            
            // Set link ke Dashboard (Spreadsheet B)
            document.getElementById('btn-dashboard').onclick = function() {
              window.top.location.href = res.url;
            };
          } else {
            document.getElementById('status').innerText = res.message;
          }
        }).checkLogin(user, pass);
      }
    </script>
  </body>
</html>
